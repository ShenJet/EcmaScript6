<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>03顶层对象与全局</title>
	</head>

	<body>
	</body>
	<script>
		//1
		//顶层对象， 在浏览器环境指的是window对象， 在 Node 指的是global对象。 
		//*ES5 之中， 顶层对象的属性与全局变量是等价的。
		window.a = 1;
		console.log(a) // 1

		a = 2; //改动的其实就是window.a
		console.log(window.a) // 2
		//顶层对象的属性与全局变量挂钩，被认为是 JavaScript 语言最大的设计败笔之一。

		//*从 ES6 开始，全局变量将逐步与顶层对象的属性脱钩。
		var a1 = 1;
		// 如果在 Node 的 REPL 环境，可以写成 global.a
		// 或者采用通用方法，写成 this.a
		console.log(window.a1) // 1

		let b1 = 1;
		console.log(window.b1) // undefined

		//2
		//global对象

		//ES5 的顶层对象，本身也是一个问题，因为它在各种实现里面是不统一的。
		//浏览器里面，顶层对象是window，但 Node 和 Web Worker 没有window。
		//浏览器和 Web Worker 里面，self也指向顶层对象，但是 Node 没有self。
		//Node 里面，顶层对象是global，但其他环境都不支持。
		//垫片库system.global模拟了这个提案， 可以在所有环境拿到global。


	//拓展知识：
		// CommonJS 的写法
		//require('system.global/shim')();

		// ES6 模块的写法
		import sqrt from 'a';
		console.log(sqrt(9));
		//上面代码可以保证各种环境里面， global对象都是存在的。

		// CommonJS 的写法
		//var global = require('system.global')();

		// ES6 模块的写法
//		import getGlobal from 'system.global';
//		const global = getGlobal();
		//上面代码将顶层对象放入变量global。
	</script>

</html>